---
import BaseLayout from '@/layouts/BaseLayout.astro';
import Header from '@/components/Header';
import BottomNav from '@/components/BottomNav';
---

<BaseLayout title="Knowledge - nexs">
  <div class="min-h-screen bg-white flex flex-col">
    <Header
      title="Knowledge"
      subtitle="仮説から社会の更新まで。リンク可能な知識コンポーネント"
      client:load
    />

    <main class="flex-1 pt-24 pb-32 px-5 max-w-md mx-auto w-full animate-fade-in-up">
      <!-- Category Filter -->
      <section class="mb-8">
        <div class="flex flex-wrap gap-2">
          <button class="category-pill is-active text-xs font-bold text-white bg-gray-900 border border-gray-900 rounded-full px-3 py-1.5 transition-colors" type="button" data-category="foundation">認識</button>
          <button class="category-pill text-xs font-bold text-gray-500 bg-white border border-gray-200 rounded-full px-3 py-1.5 hover:border-gray-300 transition-colors" type="button" data-category="thesis">仮説</button>
          <button class="category-pill text-xs font-bold text-gray-500 bg-white border border-gray-200 rounded-full px-3 py-1.5 hover:border-gray-300 transition-colors" type="button" data-category="protocol">実装</button>
          <button class="category-pill text-xs font-bold text-gray-500 bg-white border border-gray-200 rounded-full px-3 py-1.5 hover:border-gray-300 transition-colors" type="button" data-category="evidence">検証</button>
          <button class="category-pill text-xs font-bold text-gray-500 bg-white border border-gray-200 rounded-full px-3 py-1.5 hover:border-gray-300 transition-colors" type="button" data-category="update">提言</button>
        </div>
      </section>

      <!-- Knowledge Items -->
      <section class="space-y-3">
        <!-- FOUNDATION -->
        <a href="/knowledge/f-001/" class="block bg-white rounded-xl border border-gray-100 p-5 shadow-sm hover:shadow-md hover:border-gray-200 transition-all cursor-pointer knowledge-item" data-category="foundation">
          <div class="flex items-start justify-between mb-2">
            <span class="text-xs font-bold text-gray-500">基盤認識</span>
            <span class="text-sm font-mono text-gray-400">#F-001</span>
          </div>
          <h3 class="text-base font-bold text-gray-900 mb-1">適者生存の誤読</h3>
          <p class="text-sm text-gray-600 leading-normal line-clamp-3 mb-1">
            ダーウィン進化論がしばしば誤解される理由と、組織進化への影響について。競争ではなく適応のプロセスとして再解釈を試みます。
          </p>
          <!-- Author & Date -->
          <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-50">
            <div class="flex items-center gap-2">
              <div class="w-5 h-5 rounded-full bg-gray-100 flex items-center justify-center text-[9px] text-gray-500 font-bold">N</div>
              <span class="text-xs text-gray-500">nexs Research</span>
            </div>
            <span class="text-xs text-gray-400 font-mono">2024.10.05</span>
          </div>
        </a>

        <!-- FOUNDATION -->
        <a href="/knowledge/f-002/" class="block bg-white rounded-xl border border-gray-100 p-5 shadow-sm hover:shadow-md hover:border-gray-200 transition-all cursor-pointer knowledge-item" data-category="foundation">
          <div class="flex items-start justify-between mb-2">
            <span class="text-xs font-bold text-gray-500">基盤認識</span>
            <span class="text-sm font-mono text-gray-400">#F-002</span>
          </div>
          <h3 class="text-base font-bold text-gray-900 mb-1">贈与経済の再定義</h3>
          <p class="text-sm text-gray-600 leading-normal line-clamp-3 mb-1">
            デジタル社会における相互扶助と価値交換の新しい形態について。金銭的リターンを前提としない貢献が、いかにして持続可能なシステムを形成するかを分析します。
          </p>
          <!-- Author & Date -->
          <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-50">
            <div class="flex items-center gap-2">
              <div class="w-5 h-5 rounded-full bg-gray-100 flex items-center justify-center text-[9px] text-gray-500 font-bold">S</div>
              <span class="text-xs text-gray-500">K. Suzuki</span>
            </div>
            <span class="text-xs text-gray-400 font-mono">2024.11.12</span>
          </div>
        </a>

        <!-- THESIS -->
        <a href="/knowledge/t-001/" class="block bg-white rounded-xl border border-gray-100 p-5 shadow-sm hover:shadow-md hover:border-gray-200 transition-all cursor-pointer knowledge-item hidden" data-category="thesis">
          <div class="flex items-start justify-between mb-2">
            <span class="text-xs font-bold text-gray-500">仮説・問い</span>
            <span class="text-sm font-mono text-gray-400">#T-001</span>
          </div>
          <h3 class="text-base font-bold text-gray-900 mb-1">分散型自律組織の可能性</h3>
          <p class="text-sm text-gray-600 leading-normal line-clamp-3 mb-1">
            DAO技術を社会的インパクト組織に応用する際の課題と機会。意思決定コストと透明性のトレードオフをどう設計するか。
          </p>
          <!-- Author & Date -->
          <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-50">
            <div class="flex items-center gap-2">
              <div class="w-5 h-5 rounded-full bg-gray-100 flex items-center justify-center text-[9px] text-gray-500 font-bold">D</div>
              <span class="text-xs text-gray-500">DAO Lab</span>
            </div>
            <span class="text-xs text-gray-400 font-mono">2024.12.01</span>
          </div>
        </a>

        <!-- PROTOCOL -->
        <a href="/knowledge/p-001/" class="block bg-white rounded-xl border border-gray-100 p-5 shadow-sm hover:shadow-md hover:border-gray-200 transition-all cursor-pointer knowledge-item hidden" data-category="protocol">
          <div class="flex items-start justify-between mb-2">
            <span class="text-xs font-bold text-gray-500">実装計画</span>
            <span class="text-sm font-mono text-gray-400">#P-001</span>
          </div>
          <h3 class="text-base font-bold text-gray-900 mb-1">地域通貨実証実験</h3>
          <p class="text-sm text-gray-600 leading-normal line-clamp-3 mb-1">
            AI価格推定システムを用いた地域通貨導入パイロット。期間・対象・KPIの設定詳細と運用ルールについて。
          </p>
          <!-- Author & Date -->
          <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-50">
            <div class="flex items-center gap-2">
              <div class="w-5 h-5 rounded-full bg-gray-100 flex items-center justify-center text-[9px] text-gray-500 font-bold">P</div>
              <span class="text-xs text-gray-500">Project Team A</span>
            </div>
            <span class="text-xs text-gray-400 font-mono">2025.01.10</span>
          </div>
        </a>

        <!-- EVIDENCE -->
        <a href="/knowledge/e-001/" class="block bg-white rounded-xl border border-gray-100 p-5 shadow-sm hover:shadow-md hover:border-gray-200 transition-all cursor-pointer knowledge-item hidden" data-category="evidence">
          <div class="flex items-start justify-between mb-2">
            <span class="text-xs font-bold text-gray-500">経過・検証</span>
            <span class="text-sm font-mono text-gray-400">#E-001</span>
          </div>
          <h3 class="text-base font-bold text-gray-900 mb-1">3ヶ月間の交換頻度推移</h3>
          <p class="text-sm text-gray-600 leading-normal line-clamp-3 mb-1">
            パイロットコミュニティにおける通貨流通速度の変化データと分析。初期の停滞期を脱した要因についての考察。
          </p>
          <!-- Author & Date -->
          <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-50">
            <div class="flex items-center gap-2">
              <div class="w-5 h-5 rounded-full bg-gray-100 flex items-center justify-center text-[9px] text-gray-500 font-bold">A</div>
              <span class="text-xs text-gray-500">Analytics Unit</span>
            </div>
            <span class="text-xs text-gray-400 font-mono">2025.04.15</span>
          </div>
        </a>

        <!-- UPDATE -->
        <a href="/knowledge/u-001/" class="block bg-white rounded-xl border border-gray-100 p-5 shadow-sm hover:shadow-md hover:border-gray-200 transition-all cursor-pointer knowledge-item hidden" data-category="update">
          <div class="flex items-start justify-between mb-2">
            <span class="text-xs font-bold text-gray-500">デザイン提言</span>
            <span class="text-sm font-mono text-gray-400">#U-001</span>
          </div>
          <h3 class="text-base font-bold text-gray-900 mb-1">新たな共助モデルの提言</h3>
          <p class="text-sm text-gray-600 leading-normal line-clamp-3 mb-1">
            実証結果に基づく、デジタル時代の地域共助システム再構築への提案。既存の社会保障を補完する第3のセーフティネットとして。
          </p>
          <!-- Author & Date -->
          <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-50">
            <div class="flex items-center gap-2">
              <div class="w-5 h-5 rounded-full bg-gray-100 flex items-center justify-center text-[9px] text-gray-500 font-bold">N</div>
              <span class="text-xs text-gray-500">nexs Research</span>
            </div>
            <span class="text-xs text-gray-400 font-mono">2025.05.20</span>
          </div>
        </a>
      </section>
    </main>

    <BottomNav activeTab="knowledge" client:load />
  </div>
</BaseLayout>

<script is:inline>
  const categoryButtons = document.querySelectorAll('.category-pill');
  const knowledgeItems = document.querySelectorAll('.knowledge-item');

  categoryButtons.forEach((button) => {
    button.addEventListener('click', () => {
      // Update active button
      categoryButtons.forEach((b) => b.classList.remove('is-active'));
      button.classList.add('is-active');
      button.classList.add('text-white', 'bg-gray-900', 'border-gray-900');
      button.classList.remove('text-gray-500', 'border-gray-200');

      // Update item visibility
      const selectedCategory = button.getAttribute('data-category');
      knowledgeItems.forEach((item) => {
        if (item.getAttribute('data-category') === selectedCategory) {
          item.classList.remove('hidden');
        } else {
          item.classList.add('hidden');
        }
      });
    });
  });
</script>

<style>
  .category-pill.is-active {
    background-color: #111827;
    border-color: #111827;
    color: #ffffff;
  }
</style>
