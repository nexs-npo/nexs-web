# ========================================
# nexs - Environment Variables Template
# ========================================
# Copy this file to `.env` and fill in your actual values.
# NEVER commit the `.env` file to version control.
#
# Usage:
#   cp .env.example .env
#   # Edit .env with your actual values
#   npm run dev

# ----------------------------------------
# Clerk (Authentication) — DISABLED BY DEFAULT
# ----------------------------------------
# Clerk handles user authentication and PII management
# as part of the Zero PII Strategy (see docs/01_PHILOSOPHY.md).
#
# Clerk is DISABLED when these keys are not set.
# To enable: uncomment and set your keys from https://dashboard.clerk.com
#
# How it works:
#   - astro.config.mjs checks for PUBLIC_CLERK_PUBLISHABLE_KEY
#   - If present → Clerk integration is loaded (auth UI, middleware, etc.)
#   - If absent  → Clerk is skipped, site runs without authentication
#
# PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_your_key_here
# CLERK_SECRET_KEY=sk_test_your_key_here
#
# Role Management:
#   Member roles are managed in Clerk Dashboard via publicMetadata.
#   To set a user's role:
#     1. Go to Clerk Dashboard → Users → Select user
#     2. Click "Metadata" tab → "Public" section
#     3. Add: {"role": "board"}
#
#   Available roles:
#     - admin      (システム管理者 - full permissions)
#     - board      (ボードメンバー - governance & approvals)
#     - office     (事務局メンバー - operations & documents)
#     - regular    (正会員 - research & contributions)
#     - supporter  (賛助会員 - reading & comments)
#
#   See: src/lib/roles.ts for type definitions

# ----------------------------------------
# Supabase (Cloud Database)
# ----------------------------------------
# Supabase Cloud (https://supabase.com) — Free Tier.
# Stores only public data + opaque Clerk userIds (no PII).
#
# Setup:
#   1. Create project at https://supabase.com
#   2. Go to Settings → API
#   3. Copy Project URL, anon key, and service_role key
#
PUBLIC_SUPABASE_URL=https://your-project-ref.supabase.co
# Anon key (safe to expose in frontend, protected by RLS)
PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key_here
# Service role key (KEEP SECRET - server-side only, bypasses RLS)
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here

# ----------------------------------------
# DocuSeal (Digital Signature Engine) — DISABLED BY DEFAULT
# ----------------------------------------
# DocuSeal handles electronic signature execution as part of the
# digital signature system (see .work/PLAN.md).
#
# DocuSeal is DISABLED when these keys are not set.
# To enable: uncomment and set your keys after deploying DocuSeal on Coolify.
#
# How it works:
#   - nexs-web creates signature requests via DocuSeal API
#   - Users sign documents in DocuSeal's embedded UI
#   - DocuSeal sends completion webhooks back to nexs-web
#   - Signed PDFs are uploaded to Google Workspace
#   - Signature metadata (Clerk userId, timestamp, hash) stored in Supabase
#
# Security:
#   - API URL should be internal-only (not publicly accessible)
#   - API_KEY is server-side only (NEVER expose to frontend)
#   - WEBHOOK_SECRET is used to verify webhook authenticity
#
# DOCUSEAL_API_URL=https://docuseal.internal.yourdomain.com
# DOCUSEAL_API_KEY=ds_api_your_key_here
# DOCUSEAL_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# ----------------------------------------
# Google Workspace (Signed PDF Storage) — DISABLED BY DEFAULT
# ----------------------------------------
# Google Drive is used to store signed PDFs (Phase 4 implementation).
# This is an exception to the Zero PII Strategy - signed PDFs contain
# personal information and are stored on enterprise SaaS (Google Workspace)
# rather than self-hosted infrastructure.
#
# Setup:
#   1. Create a Google Cloud Project
#   2. Enable Google Drive API
#   3. Create a Service Account with Drive access
#   4. Download the service account JSON key
#   5. Base64-encode the JSON key: cat key.json | base64 -w 0
#   6. Set the encoded key as GOOGLE_SERVICE_ACCOUNT_KEY
#   7. Create a folder in Google Drive and get its ID from the URL
#
# GOOGLE_SERVICE_ACCOUNT_KEY=base64_encoded_service_account_json
# GOOGLE_DRIVE_FOLDER_ID=your_google_drive_folder_id

# ----------------------------------------
# Preview Environment (Coolify / Docker)
# ----------------------------------------
# Set to "true" in preview/staging environments to skip middleware.
# This is a workaround for Docker container environments where
# middleware env access can be unstable.
#
# Leave unset (or set to "false") in production.
#
# PREVIEW_MODE=true

# ----------------------------------------
# Site Configuration
# ----------------------------------------
PUBLIC_SITE_URL=https://nexs.or.jp
PUBLIC_SITE_NAME=nexs
PUBLIC_SITE_DESCRIPTION=次世代社会デザイン研究機構

# ----------------------------------------
# Preview Auth (Basic Auth) — DISABLED BY DEFAULT
# ----------------------------------------
# Basic authentication for preview/staging environments.
# Same pattern as Clerk: variable present → active, absent → skipped.
#
# When PREVIEW_AUTH_PASSWORD is set, all pages (except /health) require
# Basic Auth. When unset, the site is publicly accessible (production).
#
# PREVIEW_AUTH_USER=preview
# PREVIEW_AUTH_PASSWORD=your_preview_password_here

# ----------------------------------------
# Resend (Contact Form Email) — DISABLED BY DEFAULT
# ----------------------------------------
# API key from https://resend.com
# When set, the /contact form sends email via Resend API.
# When unset, the form returns 503 (service unavailable).
#
# Requires: nexs.or.jp domain verified in Resend dashboard.
#
# RESEND_API_KEY=re_your_api_key_here

# ----------------------------------------
# Feature Flags (Optional)
# ----------------------------------------
# Enable PWA features
PUBLIC_ENABLE_PWA=true
# Enable service worker for offline support
PUBLIC_ENABLE_OFFLINE=true
# Enable push notifications (future)
PUBLIC_ENABLE_PUSH_NOTIFICATIONS=false
