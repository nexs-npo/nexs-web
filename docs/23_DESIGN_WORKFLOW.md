# 23. Design Workflow

**Version:** 1.0
**Created:** 2026-02 with Claude Code (Sonnet 4.5)

このドキュメントは、**デザインチーム（スタッフ）** と **開発AI** が連携してページをデザイン・実装するための標準プロセスです。

---

## 📌 ワークフロー全体の流れ

```
┌─────────────────────┐
│ 1. スナップショット │  開発AIが最新の実装から
│    生成（開発AI）   │  静的HTMLを自動生成
└──────────┬──────────┘
           │
           ↓
┌─────────────────────┐
│ 2. デザイン編集     │  スタッフがHTMLファイルを編集
│    （スタッフ）     │  またはスクリーンショットで指示
└──────────┬──────────┘
           │
           ↓
┌─────────────────────┐
│ 3. 編集内容の共有   │  スタッフが開発AIに
│    （スタッフ）     │  編集済みファイルを共有
└──────────┬──────────┘
           │
           ↓
┌─────────────────────┐
│ 4. 実装・反映       │  開発AIが変更を
│    （開発AI）       │  実装ファイルに反映
└──────────┬──────────┘
           │
           ↓
┌─────────────────────┐
│ 5. テスト・デプロイ │  build & push
│    （開発AI）       │
└─────────────────────┘
```

---

## 👥 デザインチーム（スタッフ）の作業

### Step 1: スナップショットを依頼

開発AIに最新のデザインスナップショットを依頼します：

```
「最新のデザインスナップショットを作成してください」
```

または、特定のページだけ必要な場合：

```
「Library ページのスナップショットをください」
```

### Step 2: HTMLファイルを受け取り、ブラウザで開く

開発AIから受け取ったHTMLファイル（例: `index.html`, `library.html`）をダブルクリックしてブラウザで開きます。

**ポイント:**
- Tailwind CSSはCDN経由で読み込まれるため、ファイルを開くだけで正しく表示されます
- JavaScriptは削除されているため、ボタン等の動きは確認できませんが、デザイン確認には十分です

### Step 3: デザインを編集

以下のいずれかの方法で編集：

#### 方法A: DevTools でライブ編集（推奨）

1. ブラウザで F12 キーを押して DevTools を開く
2. Elements タブで HTML/CSS を直接編集
3. 変更を確認しながらリアルタイムで調整
4. 完成したら、変更箇所のスクリーンショットを撮影

#### 方法B: HTMLファイルを直接編集

1. VSCode やテキストエディタで HTMLファイルを開く
2. class 名やテキストを変更
3. ブラウザで再読み込みして確認
4. 完成したら編集済みHTMLファイルを保存

#### 方法C: デザインツールで加工

1. ブラウザでページのスクリーンショットを撮影
2. Figma, Photoshop, Canva 等で編集
3. 完成イメージを画像として保存

### Step 4: 編集内容を開発AIに共有

以下のいずれかの方法で共有：

**パターン1: 編集済みHTMLファイルを共有**
```
「添付のindex.htmlの通りにHeroセクションを更新してください」
（ファイル: index.html）
```

**パターン2: スクリーンショットで指示**
```
「Libraryページのカテゴリフィルターを添付画像の通りに変更してください」
（画像: library-new-design.png）
```

**パターン3: テキストで詳細指示**
```
「Officeページの以下を変更してください：
- Hero セクションのタイトルを "意思決定を、もっと自由に。" に変更
- Active Moduleカードの背景色を bg-gray-50 に変更
- Coming Soonセクションのアイコンサイズを w-6 h-6 に拡大」
```

---

## 🤖 開発AI（実装者）の作業

### Step 1: スナップショット生成

スタッフから依頼があったら、以下のコマンドでスナップショットを生成：

```bash
# 開発サーバーが起動していることを確認
npm run dev

# 別のターミナルでスナップショット生成
npm run design:snapshot
```

生成されたファイル（`_design_snapshots/` 内）をスタッフに共有します。

**補足**: スナップショットツールの詳細は `docs/tools/design-snapshot.md` を参照。

### Step 2: 編集内容を受け取り、確認

スタッフから受け取った編集内容（HTMLファイル、スクリーンショット、指示文）を確認します。

**確認ポイント:**
- どのページの、どのセクションが変更されているか
- 変更内容は構造の変更か、スタイルの変更か、テキストの変更か
- 変更はデザインガイドライン（モノトーン、モバイルファースト等）に沿っているか

### Step 3: 対応する実装ファイルに反映

| スナップショット | 実装ファイル |
|---|---|
| index.html | src/pages/index.astro |
| lab.html | src/pages/lab.astro |
| library.html | src/pages/library.astro |
| office.html | src/pages/office.astro |
| mydesk.html | src/pages/mydesk.astro |

**実装時の注意点:**

1. **構造の変更**: HTML構造が変わっている場合は、Astro ファイルの構造も同じように変更
2. **class 名の変更**: Tailwind のclass名が変わっている場合は、そのまま反映
3. **テキストの変更**: 内容を確認し、適切に反映（ダミーテキストの場合は実際の内容に置き換え）
4. **動的要素**: スナップショットにはJavaScriptがないため、ボタンの動作等は既存の実装を維持

### Step 4: デザイン統一性の確認

複数ページを変更する場合、以下の統一性を保つ：

- **背景色**: 全ページ `bg-white` または `bg-gray-50`
- **モノトーン配色**: gray-900, gray-800, ... gray-100 のみ
- **フッターナビゲーション**: 全ページ共通（`BottomNav.tsx`）
- **ボタンスタイル**: 同じ目的なら同じ class を使用
- **テキストサイズ**: 見出し、本文で一貫性

### Step 5: ビルド確認・デプロイ

```bash
# ビルドテスト
npm run build

# ローカルで確認
npm run preview

# 問題なければコミット・プッシュ
git add .
git commit -m "feat: Update [ページ名] design based on snapshot feedback"
git push
```

---

## 🎨 デザイン実装のルール

### Rule 1: 常にスナップショットから始める

```
❌ やってはいけない：
   既存の Astro ファイルを直接編集して「これくらいなら」と進める

✅ 正しい方法：
   1. スナップショットを生成してスタッフに共有
   2. スタッフが編集・確認 OK を出す
   3. それを参照して Astro ファイルを実装
```

### Rule 2: 構造の大きな変更は別途相談

レイアウトの根本的な変更（セクションの追加・削除、ページ構造の変更等）が必要な場合：

1. スタッフに相談
2. スナップショットで新しい構造を確認
3. OK が出たら実装

### Rule 3: class 名は Tailwind のみ

inline style や id を追加しない。すべて class ベースで実装。

```html
<!-- ✅ OK -->
<div class="text-sm font-bold text-gray-900">...</div>

<!-- ❌ NG -->
<div class="text-sm font-bold text-gray-900" style="margin: 10px;">...</div>
```

### Rule 4: モバイルファースト

すべてのページは `max-w-md mx-auto px-5` を基本とし、モバイルサイズで最適化します。

```html
<!-- 標準パターン -->
<div class="px-5 max-w-md mx-auto w-full">
  <!-- コンテンツ -->
</div>
```

---

## 📂 関連ファイル

```
nexs-web/
├── scripts/
│   └── snapshot.js
│       → スナップショット生成スクリプト
│
├── _design_snapshots/
│   ├── index.html
│   ├── lab.html
│   ├── library.html
│   ├── office.html
│   └── mydesk.html
│       → 自動生成される静的HTML（gitignore済み）
│
├── src/pages/
│   ├── index.astro
│   ├── lab.astro
│   ├── library.astro
│   ├── office.astro
│   └── mydesk.astro
│       → 実装ファイル
│
└── docs/
    ├── DESIGN_WORKFLOW.md
    │   → 【このファイル】ワークフロー説明
    │
    ├── tools/design-snapshot.md
    │   → スナップショットツールの詳細ドキュメント
    │
    └── 04_UI_UX_GUIDELINES.md
        → デザインガイドライン
```

---

## 🚀 今後のワークフロー改善

以下は、実装を通じて決めること：

- デザイン変更の「確認フロー」（誰が最終確認するか）
- 「修正完了」の定義（Build 成功？ 見た目確認？）
- スナップショット更新の「頻度」（毎回？ まとめて？）
- エラーが出たときの「報告フォーマット」

---

**作成日**: 2026年1月
**更新日**: 2026年2月（スナップショットツール導入に伴う全面改訂）
**ステータス**: 運用開始版
**次回更新**: ワークフロー実行を通じてルール改善
